#!/usr/bin/env node

// Generate sitemap.xml for EyeCare Center Orange County
import fs from 'fs';
import { generateSitemapXML } from './src/utils/generateSitemap.js';

console.log('üöÄ Generating comprehensive sitemap for EyeCare Center Orange County...\n');

try {
  // Generate the sitemap XML content
  const sitemapXML = generateSitemapXML();

  // Write to public directory (for development server access)
  const publicPath = './public/sitemap.xml';
  fs.writeFileSync(publicPath, sitemapXML, 'utf8');
  console.log(`‚úÖ Sitemap generated: ${publicPath}`);

  // Also write to dist directory (for production builds)
  const distPath = './dist/sitemap.xml';
  if (fs.existsSync('./dist')) {
    fs.writeFileSync(distPath, sitemapXML, 'utf8');
    console.log(`‚úÖ Sitemap generated: ${distPath}`);
  }

  // Count the URLs
  const urlCount = (sitemapXML.match(/<url>/g) || []).length;
  console.log(`\nüìä Sitemap Statistics:`);
  console.log(`   ‚Ä¢ Total URLs: ${urlCount}`);
  console.log(`   ‚Ä¢ File Size: ${(sitemapXML.length / 1024).toFixed(2)} KB`);

  // Show sample URLs
  const urlMatches = sitemapXML.match(/<loc>(.*?)<\/loc>/g);
  if (urlMatches && urlMatches.length > 0) {
    console.log(`\nüìã Sample URLs (first 10):`);
    urlMatches.slice(0, 10).forEach((url, index) => {
      const cleanUrl = url.replace('<loc>', '').replace('</loc>', '');
      console.log(`   ${index + 1}. ${cleanUrl}`);
    });

    if (urlMatches.length > 10) {
      console.log(`   ... and ${urlMatches.length - 10} more URLs`);
    }
  }

  console.log(`\nüéØ SEO Optimizations Applied:`);
  console.log(`   ‚Ä¢ Ophthalmology + Optometry keywords`);
  console.log(`   ‚Ä¢ Orange County geographic targeting`);
  console.log(`   ‚Ä¢ Medical procedure terminology`);
  console.log(`   ‚Ä¢ Advanced procedure highlighting`);
  console.log(`   ‚Ä¢ Urgent care positioning`);

  console.log(`\n‚ú® Ready for Google Search Console submission!`);
  console.log(`   Submit: https://eyecarecenteroc.com/sitemap.xml`);

} catch (error) {
  console.error('‚ùå Error generating sitemap:', error.message);
  process.exit(1);
}